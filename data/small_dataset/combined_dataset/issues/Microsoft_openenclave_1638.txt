CMake samples cleanup


This PR rebases and so replaces #1618, original below:
This PR takes care of a few tasks regarding the samples build system.
Fixes: #1606
Fixes: #1588
Fixes: #1605
Fixes: #1590
Fixes: #1357
