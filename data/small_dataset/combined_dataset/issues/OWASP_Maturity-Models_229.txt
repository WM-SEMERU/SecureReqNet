Data validation for user supplied data is not consistent and there are multiple cases of DoS


See #225 for a real example
