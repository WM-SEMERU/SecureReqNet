Add support for direction annotations


closes #334
