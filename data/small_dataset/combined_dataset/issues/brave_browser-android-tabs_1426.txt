Code review refactor


Closes #1303
Closes #1263
