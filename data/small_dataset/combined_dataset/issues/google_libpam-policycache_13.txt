Misc hardening and error cleanup





