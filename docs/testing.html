---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/05_testing.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_testing.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">run</span> 09_utils.ipynb
<span class="kn">from</span> <span class="nn">utils.vectorize_sentence</span> <span class="kn">import</span> <span class="n">Embeddings</span>
<span class="c1">#all_util</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Dynamic_Dataset" class="doc_header"><code>class</code> <code>Dynamic_Dataset</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Dynamic_Dataset</code>(<strong><code>ground_truth</code></strong>, <strong><code>path</code></strong>, <strong><code>isZip</code></strong>)</p>
</blockquote>
<p>This class efficiently 'stores' a dataset. Only a list of filenames and
mappings to their ground truth values are stored in memory. The file
contents are only brought into memory when requested.</p>
<p>This class supports indexing, slicing, and iteration.</p>
<p>A user can treat an instance of this class exactly as they would a list.
Indexing an instance of this class will return a tuple consisting of
the ground truth value and the file content of the filename at that index.</p>
<p>A user can request the filename at an index with get_id(index)</p>
<p>Example:</p>

<pre><code>dataset = Dynamic_Dataset(ground_truth)

print(dataset.get_id(0))
    -&gt; gitlab_79.txt

print(dataset[0])
    -&gt; ('(1,0)', 'The currently used Rails version, in the stable ...

for x in dataset[2:4]:
    print(x)
        -&gt; ('(1,0)', "'In my attempt to add 2 factor authentication ...
        -&gt; ('(1,0)', 'We just had an admin accidentally push to a ...</code></pre>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Processing_Dataset" class="doc_header"><code>class</code> <code>Processing_Dataset</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Processing_Dataset</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>A class to wrap up processing functions</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Embeddings" class="doc_header"><code>class</code> <code>Embeddings</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Embeddings</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: get_ground_truth()</span>
<span class="k">def</span> <span class="nf">test_get_gt</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gitlab_79.txt&#39;</span><span class="p">:</span><span class="s1">&#39;(1,0)&#39;</span><span class="p">}</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">ground_truth</span> <span class="o">==</span> <span class="n">expected</span><span class="p">)</span>

<span class="c1">#util</span>
<span class="n">test_get_gt</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># contains a duplicate</span>
<span class="c1"># method tested: get_ground_truth()</span>
<span class="k">def</span> <span class="nf">test_get_gt_dup_error</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_dup/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#util</span>
<span class="n">test_get_gt_dup_error</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: __getitem__</span>
<span class="k">def</span> <span class="nf">test_dd_get</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_multiple/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(1,0)&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;The currently used Rails version, in the stable branch, is insecure</span><span class="se">\n\n</span><span class="s1">You should update the Gemfile.lock to hotfix this.</span><span class="se">\n\n</span><span class="s1">http://weblog.rubyonrails.org/2014/2/18/Rails_3_2_17_4_0_3_and_4_1_0_beta2_have_been_released/&#39;</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">expected</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;(1,0)&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;&#39;This is a useful security improvement, that I recommend gets integrated into gitlab. It protects users, in the event that their passwords get stolen from other sites, etc. I found a good gem for this: http://rubydoc.info/github/mdp/rotp/master/frames, however, given that it appears Gitlab uses Devise for auth, we should probably use this plugin: https://github.com/wmlele/devise-otp</span><span class="se">\n\n</span><span class="s2">I intend to submit a Merge Request for this, so I&#39;ll outline my design for the system here (in case anyone has feedback/wants to help):</span><span class="se">\n\n</span><span class="s2">### OTP Strategy</span><span class="se">\n</span><span class="s2">I&#39;m going with time-based (TOTP). Its requires no storage implications, per-user (other than a 32bit secret key). Time-based keys are very common, Google uses this strategy to protect GMail/Apps customers.</span><span class="se">\n\n</span><span class="s2">### Database Augmentation</span><span class="se">\n</span><span class="s2">**NOTE:** Given the existence of devise-otp, this may no longer be necessary.</span><span class="se">\n\n</span><span class="s2">I will add new table, with a foreign key reference to a `user_id` column,  and `totp_secret` column. The existence of a row implies that this feature is enabled for a user. This table could be enhanced further down the road to support other types of otp strategies, if need be. This would also make future data migrations, in the event of further enhancement, easier to manage.</span><span class="se">\n\n</span><span class="s2">### UI Augmentation</span><span class="se">\n</span><span class="s2">#### User Account Settings</span><span class="se">\n</span><span class="s2">We&#39;ll add a simple checkbox that a user must toggle to enable this feature. Once the checkbox is toggled, a modal will appear, displaying a QR code that the user will then scan with their mobile device, to start generating OTP codes. There will also be a box for the user to provide a newly generated OTP code to verify the service is working properly, for their account. Users will also need the ability to also reset the secret, in case they lose their phone etc.</span><span class="se">\n\n</span><span class="s2">#### Admin Settings</span><span class="se">\n</span><span class="s2">We&#39;ll need to allow admins to toggle if this feature is enabled, for a given user account. Assumed use case would be to contact an admin to disable OTP codes so you can log back in, re-enable it, and setup a new secret for yourself.</span><span class="se">\n\n</span><span class="s2">#### Sign In</span><span class="se">\n</span><span class="s2">Once the user has provided a proper username/password pair, if the flag is enabled, they will be redirected to a page that asks them to enter an OTP code, before they can proceed into the protected areas of the site.</span><span class="se">\n\n</span><span class="s2">------</span><span class="se">\n\n</span><span class="s2">**QUESTION: What would be the best course of action to manage the scenario where a user has lost their phone, and can no longer regenerate OTP codes to access their account? How can we let them back in to reset their OTP secret?** So far, my assumption is that the user would contact their gitlab administrators and they would disable OTP for them. However, one potential issue with this is that the attacker, who may have the user&#39;s password, may also have access to their e-mail. This would allow them to ask the administrator to disable OTP, and gain access to their data. Likely the verification protocol for admins should be org-specific, and not in scope of this work. Unsure how gitlab cloud staff wants to manage this, for their users. </span><span class="se">\n\n</span><span class="s2">**UPDATE:** Its worth noting that using devise-otp provides a list of emergency HTOP recovery tokens that can be used, if we expose that functionality.&quot;</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">expected</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_get</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_dd_slice</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_multiple/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">sliced</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sliced</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">sliced</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#util</span>
<span class="n">test_dd_slice</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: __getitem__</span>
<span class="k">def</span> <span class="nf">test_dd_get_error</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_get_error</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: get_id()</span>
<span class="k">def</span> <span class="nf">test_dd_get_id</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="s1">&#39;gitlab_79.txt&#39;</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_get_id</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: get_id()</span>
<span class="k">def</span> <span class="nf">test_dd_get_id_error</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_get_id_error</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: len()</span>
<span class="k">def</span> <span class="nf">test_dd_len</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_multiple/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_len</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: __iter__</span>
<span class="k">def</span> <span class="nf">test_dd_iter</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_multiple/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># assuming that len and indexing are implemented correctly</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
        <span class="n">expected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">:</span>
        <span class="n">actual</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">expected</span> <span class="o">==</span> <span class="n">actual</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_iter</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: __set_item__</span>
<span class="k">def</span> <span class="nf">test_dd_set_item_error</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dynamic_Dataset</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="s2">&quot;../test/&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;asdf&quot;</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_dd_set_item_error</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># data is detected in document</span>
<span class="c1"># method tested: get_test_and_training</span>
<span class="k">def</span> <span class="nf">test_get_test_training_value_error</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_bad/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
        <span class="n">process_unit</span><span class="o">.</span><span class="n">get_test_and_training</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_get_test_training_value_error</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: get_issue(filename)</span>

<span class="k">def</span> <span class="nf">test_get_issue_bad</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_bad/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">process_unit</span><span class="o">.</span><span class="n">get_issue</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_get_issue_bad</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># method tested: get_issue(filename)</span>

<span class="k">def</span> <span class="nf">test_get_issue</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../test/test_gt_good/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">process_unit</span><span class="o">.</span><span class="n">get_issue</span><span class="p">(</span><span class="s2">&quot;full_ground_truth.txt&quot;</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_get_issue</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># data is detected in document</span>
<span class="c1"># method tested: get_test_and_training</span>
<span class="k">def</span> <span class="nf">test_get_train_test_split</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;../data/augmented_dataset/&quot;</span>
    <span class="n">process_unit</span> <span class="o">=</span> <span class="n">Processing_Dataset</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_ground_truth</span><span class="p">()</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_test_and_training</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="n">test_ratio</span> <span class="o">=</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">isZip</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">actual_ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">))</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">actual_ratio</span><span class="o">&gt;=</span><span class="n">ratio</span><span class="o">-.</span><span class="mi">02</span> <span class="ow">and</span> <span class="n">actual_ratio</span><span class="o">&lt;=</span><span class="n">ratio</span><span class="o">+</span><span class="mf">0.02</span><span class="p">)</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">process_unit</span><span class="o">.</span><span class="n">get_test_and_training</span><span class="p">(</span><span class="n">ground_truth</span><span class="p">,</span> <span class="n">test_ratio</span> <span class="o">=</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">isZip</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">actual_ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">))</span>

    <span class="k">assert</span><span class="p">(</span><span class="n">actual_ratio</span><span class="o">&gt;=</span><span class="n">ratio</span><span class="o">-.</span><span class="mi">02</span> <span class="ow">and</span> <span class="n">actual_ratio</span><span class="o">&lt;=</span><span class="n">ratio</span><span class="o">+</span><span class="mf">0.02</span><span class="p">)</span>
<span class="c1">#util</span>
<span class="n">test_get_train_test_split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

